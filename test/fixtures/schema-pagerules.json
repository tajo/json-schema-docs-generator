{
  "id": "/recursive/pagerules",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "type": "object",
  "definitions": {
    "conditions": {
      "description": "",
      "oneOf": [
        {"$ref": "#/definitions/condition"},
        {"$ref": "#/definitions/filter_id"}
      ]
    },
    "condition": {
      "type": "object",
      "description": "A logic tree of how to decide whether to apply the page rule to a request.",
      "properties": {
        "operation": {
          "enum": ["and", "or"],
          "description": "How to evaluate the set of operands",
          "notes" : "Existence/not existence checks are handled by the existence constraint",
          "default": "all"
        },
        "parameters": {
          "type": "array",
          "minimum": 1,
          "maximum": 2,
          "items": {
            "oneOf": [
              {"$ref": "#/definitions/filter_id"},
              {"$ref": "#/definitions/condition"}
            ]
          }
        }
      }
    },
    "filter_id": {
      "enum": ["A", "B"],
      "description": "The filter identifier. This must be a single character capital letter",
      "example": "A"
    }
  },
  "properties": {
    "conditions": "#/definitions/conditions"
  }
}
